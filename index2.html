<html>
<head>
<script type="text/javascript" src="js/jquery-1.4.1.min.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

<script type="text/javascript">
var MYMAP = {
  bounds: null,
  map: null
}
MYMAP.init = function(selector, latLng, zoom) {
  var myOptions = {
    zoom:zoom,
    center: latLng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  this.map = new google.maps.Map($(selector)[0], myOptions);
  this.bounds = new google.maps.LatLngBounds();
}

MYMAP.placeMarkers = function(filename) {
  $.get(filename, function(xml){
    $(xml).find("marker").each(function(){
      var name = $(this).find('name').text();
      var address = $(this).find('address').text();
      // create a new LatLng point for the marker
      var lat = $(this).find('lat').text();
      var lng = $(this).find('lng').text();
      var point = new google.maps.LatLng(parseFloat(lat),parseFloat(lng));
      // extend the bounds to include the new point
      MYMAP.bounds.extend(point);
      // add the marker itself
      var marker = new google.maps.Marker({
        position: point,
        map: MYMAP.map
      });
      // create the tooltip and its text
      var infoWindow = new google.maps.InfoWindow();
      var html='<b>'+name+'</b><br />'+address;
      // add a listener to open the tooltip when a user clicks on one of the markers
      google.maps.event.addListener(marker, 'click', function() {
        infoWindow.setContent(html);
        infoWindow.open(MYMAP.map, marker);
      });
    });
    // Fit the map around the markers we added:
    MYMAP.map.fitBounds(MYMAP.bounds);
  });
}

</script>
</head>
<body>
  <div id="map-1"></div>
</body>
</html>

//not actually using anything below here at this stage
 var cycle_route_sections = [[[51.531281,-0.126429], [51.535126,-0.135183], [51.539288,-0.137157], [51.544041,-0.131493]],[[51.545483,-0.117588], [51.540943,-0.110893], [51.536991,-0.114841], [51.534752,-0.112610], [51.532402,-0.122137]]];


var draw_section = function (map, cycle_route_section) {

  var cycle_route_section_lat_longs = [];

  for (i = 0; i < cycle_route_section.length; i++) {
    cycle_route_section_lat_longs.push(new google.maps.LatLng(cycle_route_section[i][0], cycle_route_section[i][1]));
  }

  var section = new google.maps.Polyline({
      path: cycle_route_section_lat_longs,
      strokeColor: "#456789",
      strokeOpacity: 1.0,
      strokeWeight: 4
    });

  section.setMap(map)
}

function setMarkers(map, locations) {  

  var marker_image_url = "http://google-maps-icons.googlecode.com/files/purple0"
  var image = new google.maps.MarkerImage(marker_image_url,
    // This marker is 20 pixels wide by 32 pixels tall.
    new google.maps.Size(20, 32),
    // The origin for this image is 0,0.
    new google.maps.Point(0,0),
    // The anchor for this image is the base of the flagpole at 0,32.
    new google.maps.Point(0, 32));
  var shape = {
      coord: [1, 1, 1, 20, 18, 20, 18 , 1],
      type: 'poly'
  };

  for (var i = 0; i < locations.length; i++) {
    //put the right number on the marker
    var image = marker_image_url + (i + 1) + ".png"
    var location = locations[i];
    var myLatLng = new google.maps.LatLng(location[1], location[2]);
    var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        icon: image,
        shape: shape,
        title: location[0]
    });
  }
}
